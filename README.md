# rx-util-uploaddata-from-cover
Репозиторий с шаблоном разработки «Импорт данных с обложки модуля».

## Описание
Шаблон позволяет перенести данные в Directum RX. 
В качестве источника данных для переноса используются книги Excel с расширением XLSX.
Чтобы произвести создание записей справочников в Directum RX, достаточно заполнить специально сформированные шаблоны Excel и загрузить данные из обложки.
Утилита отличается от утилиты https://github.com/DirectumCompany/rx-util-importdata-net-core тем, что позволяет загружать записи с обложки модуля любым сотрудником (если есть права на справочники). Также есть различия с перечне загружаемых справочников. 
После каждой загрузки строиться отчет об успешно/неуспешно загруженных записях.

### На текущий момент реализована возможность импорта записей следующих справочников:
1. Федеральный классификатор обращений граждан (разделы, темы, тематики, темы, вопросы, подвопросы).
2. Номенклатура дел (сроки хранения, номенклатура дел).
3. Орг. структура.
   3.1. Учетные записи.
   3.2. Персоны.
   3.3. Организации.
   3.4. Наши организации.
   3.5. Подразделения.
   3.6. Должности.
   3.7. Работники.
5. Населенные пункты с ГУИД ФИАС (из ФИАС (ГАР)). 

## Модификация

Для модификации требуется наличие на рабочем месте разработчика:
1. Среда разработки Directum RX.

## Порядок установки и использования

1. Импортируйте пакет разработки на рабочий слой.
2. В Directum RX появится модуль с обложкой для загрузки записей справочника.

## Порядок кастомизации утилиты (для партнеров)

Для работы требуется установленный Directum RX версии 4.0 и выше.

Установка для ознакомления
1. Склонировать репозиторий https://github.com/DirectumCompany/rx-util-importdata-net-core.git в папку.
2. Указать в _ConfigSettings.xml DDS:
```xml
<block name="REPOSITORIES">
  <repository folderName="Base" solutionType="Base" url="" /> 
  <repository folderName="<Папка из п.1>" solutionType="Work" 
     url="https://github.com/DirectumCompany/rx-util-importdata-net-core.git" />
</block>
```

### Установка для использования на проекте

Возможные варианты:

A. Fork репозитория.
1. Сделать fork репозитория <Название репозитория> для своей учетной записи.
2. Склонировать созданный в п. 1 репозиторий в папку.
3. Указать в _ConfigSettings.xml DDS:
```xml 
<block name="REPOSITORIES">
  <repository folderName="Base" solutionType="Base" url="" /> 
  <repository folderName="<Папка из п.2>" solutionType="Work" 
     url="https://github.com/DirectumCompany/rx-util-importdata-net-core.git" />
</block>
```

B. Подключение на базовый слой.
Вариант не рекомендуется, так как при выходе версии шаблона разработки не гарантируется обратная совместимость.
1. Склонировать репозиторий <Название репозитория> в папку.
2. Указать в _ConfigSettings.xml DDS:
```xml
<block name="REPOSITORIES">
  <repository folderName="Base" solutionType="Base" url="" /> 
  <repository folderName="<Папка из п.1>" solutionType="Base" 
     url="https://github.com/DirectumCompany/rx-util-importdata-net-core.git" />
  <repository folderName="<Папка для рабочего слоя>" solutionType="Work" 
     url="<Адрес репозитория для рабочего слоя>" />
</block>
```

C. Копирование репозитория в систему контроля версий.
Рекомендуемый вариант для проектов внедрения.
1. В системе контроля версий с поддержкой git создать новый репозиторий.
2. Склонировать репозиторий https://github.com/DirectumCompany/rx-util-importdata-net-core.git в папку с ключом --mirror.
3. Перейти в папку из п. 2.
4. Импортировать клонированный репозиторий в систему контроля версий командой:
git push –mirror <Адрес репозитория из п. 1>
